<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Szótáralapú elemzések, érzelem-elemzés | Szövegbányászat és mesterséges intelligencia R-ben</title>
  <meta name="description" content="8 Szótáralapú elemzések, érzelem-elemzés | Szövegbányászat és mesterséges intelligencia R-ben" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Szótáralapú elemzések, érzelem-elemzés | Szövegbányászat és mesterséges intelligencia R-ben" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Szótáralapú elemzések, érzelem-elemzés | Szövegbányászat és mesterséges intelligencia R-ben" />
  
  
  

<meta name="author" content="Sebők Miklós, Ring Orsolya" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-korpuszépítés-problémái-és-a-szövegel-készítés.html"/>
<link rel="next" href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Bevezetés</a></li>
<li class="chapter" data-level="2" data-path="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html"><a href="a-kvantitatív-szövegelemzés-és-szövegbányászat-alapfogalmai.html"><i class="fa fa-check"></i><b>2</b> A kvantitatív szövegelemzés és szövegbányászat alapfogalmai</a></li>
<li class="chapter" data-level="3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html"><i class="fa fa-check"></i><b>3</b> Az adatkezelés R-ben</a>
<ul>
<li class="chapter" data-level="3.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#adatok-importálása-és-exportálása"><i class="fa fa-check"></i><b>3.1</b> Adatok importálása és exportálása</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#szöveges-dokumentumok-importálása"><i class="fa fa-check"></i><b>3.1.1</b> Szöveges dokumentumok importálása</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#adatok-exportálása"><i class="fa fa-check"></i><b>3.2</b> Adatok exportálása</a></li>
<li class="chapter" data-level="3.3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#a-pipe-operátor"><i class="fa fa-check"></i><b>3.3</b> A pipe operátor</a></li>
<li class="chapter" data-level="3.4" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#muveletek-a-date-framekkel"><i class="fa fa-check"></i><b>3.4</b> Muveletek a date framekkel</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#megfigyelések-szűrése-filter"><i class="fa fa-check"></i><b>3.4.1</b> Megfigyelések szűrése: <code>filter()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#változók-kiválogatása-select"><i class="fa fa-check"></i><b>3.4.2</b> Változók kiválogatása: <code>select()</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#új-változók-létrehozása-mutate"><i class="fa fa-check"></i><b>3.4.3</b> Új változók létrehozása: <code>mutate()</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#csoportonkénti-statisztikák-group_by-és-summarize"><i class="fa fa-check"></i><b>3.4.4</b> Csoportonkénti statisztikák: <code>group_by()</code> és <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="az-adatkezelés-r-ben.html"><a href="az-adatkezelés-r-ben.html#munka-karakter-vektorokkaladatkezeles-4"><i class="fa fa-check"></i><b>3.5</b> Munka karakter vektorokkal</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html"><i class="fa fa-check"></i><b>4</b> Korpuszépítés és szövegelőkészítés</a>
<ul>
<li class="chapter" data-level="4.1" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#szövegbeszerzés"><i class="fa fa-check"></i><b>4.1</b> Szövegbeszerzés</a></li>
<li class="chapter" data-level="4.2" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#szövegelőkészítés"><i class="fa fa-check"></i><b>4.2</b> Szövegelőkészítés</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#string-műveletek"><i class="fa fa-check"></i><b>4.2.1</b> String műveletek</a></li>
<li class="chapter" data-level="4.2.2" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#tokenizálás-szótövezés-kisbetűsítés-és-a-stopszavak-eltávolítása"><i class="fa fa-check"></i><b>4.2.2</b> Tokenizálás, szótövezés, kisbetűsítés és a stopszavak eltávolítása</a></li>
<li class="chapter" data-level="4.2.3" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#dokumentum-kifejezés-mátrix-dtm"><i class="fa fa-check"></i><b>4.2.3</b> Dokumentum kifejezés mátrix (DTM)</a></li>
<li class="chapter" data-level="4.2.4" data-path="korpuszépítés-és-szövegel-készítés.html"><a href="korpuszépítés-és-szövegel-készítés.html#súlyozás"><i class="fa fa-check"></i><b>4.2.4</b> Súlyozás</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="leíró-statisztika-szózsák-és-szóeloszlások.html"><a href="leíró-statisztika-szózsák-és-szóeloszlások.html"><i class="fa fa-check"></i><b>5</b> Leíró statisztika: szózsák és szóeloszlások</a></li>
<li class="chapter" data-level="6" data-path="a-szövegek-reprezentálása-a-vektortérben.html"><a href="a-szövegek-reprezentálása-a-vektortérben.html"><i class="fa fa-check"></i><b>6</b> A szövegek reprezentálása a vektortérben</a></li>
<li class="chapter" data-level="7" data-path="a-korpuszépítés-problémái-és-a-szövegel-készítés.html"><a href="a-korpuszépítés-problémái-és-a-szövegel-készítés.html"><i class="fa fa-check"></i><b>7</b> A korpuszépítés problémái és a szövegelőkészítés</a></li>
<li class="chapter" data-level="8" data-path="szótáralapú-elemzések-érzelem-elemzés.html"><a href="szótáralapú-elemzések-érzelem-elemzés.html"><i class="fa fa-check"></i><b>8</b> Szótáralapú elemzések, érzelem-elemzés</a>
<ul>
<li class="chapter" data-level="8.1" data-path="szótáralapú-elemzések-érzelem-elemzés.html"><a href="szótáralapú-elemzések-érzelem-elemzés.html#szótárak-az-r-ben"><i class="fa fa-check"></i><b>8.1</b> Szótárak az R-ben</a></li>
<li class="chapter" data-level="8.2" data-path="szótáralapú-elemzések-érzelem-elemzés.html"><a href="szótáralapú-elemzések-érzelem-elemzés.html#magyar-nemzet-cikkek"><i class="fa fa-check"></i><b>8.2</b> Magyar Nemzet cikkek</a></li>
<li class="chapter" data-level="8.3" data-path="szótáralapú-elemzések-érzelem-elemzés.html"><a href="szótáralapú-elemzések-érzelem-elemzés.html#mnb-sajtóközlemények"><i class="fa fa-check"></i><b>8.3</b> MNB sajtóközlemények</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><i class="fa fa-check"></i><b>9</b> Felügyelet nélküli tanulás: Topik modellezés magyar törvényszövegeken</a>
<ul>
<li class="chapter" data-level="9.1" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html#k-közép-klaszterezés-kvalitatív-adatokkal"><i class="fa fa-check"></i><b>9.1</b> K közép klaszterezés kvalitatív adatokkal</a></li>
<li class="chapter" data-level="9.2" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html#látens-dirichlet-allokáció-topik-modellekklasztering_topicmodellek-1"><i class="fa fa-check"></i><b>9.2</b> Látens Dirichlet Allokáció topik modellek</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html#a-vem-módszer-alkalmazása-a-magyar-törvények-korpuszán"><i class="fa fa-check"></i><b>9.2.1</b> A „VEM" módszer alkalmazása a magyar törvények korpuszán</a></li>
<li class="chapter" data-level="9.2.2" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html#az-lda-gibbs-módszer-alkalmazása-a-magyar-törvények-korpuszán"><i class="fa fa-check"></i><b>9.2.2</b> Az „LDA Gibbs" módszer alkalmazása a magyar törvények korpuszán</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html"><a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html#struktúrális-topik-modellek"><i class="fa fa-check"></i><b>9.3</b> Struktúrális topik modellek</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="szóbeágyazások.html"><a href="szóbeágyazások.html"><i class="fa fa-check"></i><b>10</b> Szóbeágyazások</a>
<ul>
<li class="chapter" data-level="10.1" data-path="szóbeágyazások.html"><a href="szóbeágyazások.html#word2vec-glove-és-fasttext"><i class="fa fa-check"></i><b>10.1</b> Word2Vec, GloVe és fastText</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="szóbeágyazások.html"><a href="szóbeágyazások.html#glove-használata-magyar-média-korpuszon"><i class="fa fa-check"></i><b>10.1.1</b> GloVe használata magyar média korpuszon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html"><a href="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html"><i class="fa fa-check"></i><b>11</b> Szövegskálázás: felügyelet nélküli és felügyelt megoldások</a>
<ul>
<li class="chapter" data-level="11.1" data-path="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html"><a href="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html#wordfish"><i class="fa fa-check"></i><b>11.1</b> Wordfish</a></li>
<li class="chapter" data-level="11.2" data-path="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html"><a href="szövegskálázás-felügyelet-nélküli-és-felügyelt-megoldások.html#wordscores"><i class="fa fa-check"></i><b>11.2</b> Wordscores</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="szövegösszehasonlítás.html"><a href="szövegösszehasonlítás.html"><i class="fa fa-check"></i><b>12</b> Szövegösszehasonlítás</a></li>
<li class="chapter" data-level="13" data-path="természetes-nyelv-feldolgozás-nlp.html"><a href="természetes-nyelv-feldolgozás-nlp.html"><i class="fa fa-check"></i><b>13</b> Természetes-nyelv feldolgozás (NLP)</a></li>
<li class="chapter" data-level="14" data-path="osztályozás-és-felügyelt-tanulás.html"><a href="osztályozás-és-felügyelt-tanulás.html"><i class="fa fa-check"></i><b>14</b> Osztályozás és felügyelt tanulás</a></li>
<li class="chapter" data-level="15" data-path="függelék.html"><a href="függelék.html"><i class="fa fa-check"></i><b>15</b> Függelék</a>
<ul>
<li class="chapter" data-level="15.1" data-path="függelék.html"><a href="függelék.html#az-r-és-az-rstudio-használata"><i class="fa fa-check"></i><b>15.1</b> Az R és az RStudio használata</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="függelék.html"><a href="függelék.html#az-rstudio-kezdőfelülete"><i class="fa fa-check"></i><b>15.1.1</b> Az RStudio kezdőfelülete</a></li>
<li class="chapter" data-level="15.1.2" data-path="függelék.html"><a href="függelék.html#projektmunka"><i class="fa fa-check"></i><b>15.1.2</b> Projekt alapú munka</a></li>
<li class="chapter" data-level="15.1.3" data-path="függelék.html"><a href="függelék.html#scriptek-szerkesztése-függvények-használata"><i class="fa fa-check"></i><b>15.1.3</b> Scriptek szerkesztése, függvények használata</a></li>
<li class="chapter" data-level="15.1.4" data-path="függelék.html"><a href="függelék.html#packages"><i class="fa fa-check"></i><b>15.1.4</b> R csomagok</a></li>
<li class="chapter" data-level="15.1.5" data-path="függelék.html"><a href="függelék.html#objektumok-tárolása-értékadás"><i class="fa fa-check"></i><b>15.1.5</b> Objektumok tárolása, értékadás</a></li>
<li class="chapter" data-level="15.1.6" data-path="függelék.html"><a href="függelék.html#vektorok"><i class="fa fa-check"></i><b>15.1.6</b> Vektorok</a></li>
<li class="chapter" data-level="15.1.7" data-path="függelék.html"><a href="függelék.html#faktorok"><i class="fa fa-check"></i><b>15.1.7</b> Faktorok</a></li>
<li class="chapter" data-level="15.1.8" data-path="függelék.html"><a href="függelék.html#data-frame"><i class="fa fa-check"></i><b>15.1.8</b> Data frame</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="függelék.html"><a href="függelék.html#vizualizáció"><i class="fa fa-check"></i><b>15.2</b> Vizualizáció</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Szövegbányászat és mesterséges intelligencia R-ben</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="szótáralapú-elemzések-érzelem-elemzés" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Szótáralapú elemzések, érzelem-elemzés</h1>
<p>A szótár alapú szentiment elemzés egy egyszerű ötleten alapul. Hogyha tudjuk hogy egyes szavak milyen érzelmeket, érzéseket, információt hordoznak, akkor minél gyakoribb egy-egy érzelem kategóriához tartozó szó, akkor a szentiment annél inkább jellemző lesz a dokumentumra amit vizsgálunk. Természetesen itt is jó pár dolognak kell teljesülnie ahhoz hogy az elemzésünk eredménye megbízható legyen. Mivel a szótár alapú elemzés az adott szentiment kategórián belüli kulcsszavak gyakoriságán alapul, ezért van aki nem tekinti statisztikai elemzésnek (lásd például <span class="citation"><a href="függelék.html#ref-young2012affective" role="doc-biblioref">Young and Soroka</a> (<a href="függelék.html#ref-young2012affective" role="doc-biblioref">2012</a>)</span>). A tágabb kvantitatív szövegelemzési kontextusban az osztályozáson (classification) belül a felügyelt módszerekhez hasonlóan itt is ismert kategóriákkal dolgozunk (pl.: egy kulcsszó az “öröm” kategóriába tartozik), csak egyszerűbb módszertannal <span class="citation">(<a href="függelék.html#ref-grimmer2013text" role="doc-biblioref">Grimmer and Stewart 2013a</a>)</span>.</p>
<p>A kulcsszavakra építés miatt a módszer a kvalitatív és kvantitatív kutatási vonalak találkozásának is tekinthető, hiszen egy-egy szónak az érzelmi töltete nem mindig ítélhető meg objektíven. Mint minden módszer esetében, amiről ebben a tankönyvben szó van, itt is kiemelten fontos hogy ellenőrízzük hogy a használt szótár kategóriák és kulcsszavak fedik-e a valóságot. Más szavakkal: <em>validate, validate, validate</em>. <strong>A módszer előnyei:</strong></p>
<ul>
<li>Tökéletesen megbízható: nincsen probabilisztikus eleme a számításoknak, mint például a Support Vector alapú osztályozásnál, illetve az emberi szövegkódolásnál előforduló problémákat is elkerüljük így.</li>
<li>Képesek vagyunk vele mérni a szöveg látens dimenzióit.</li>
<li>Széles körben alkalmazható, egyszerűen számolható. A politikatudományon és számítogépes nyelvtudományokon belül nagyon sok kész szótár elérhető, amik különböző módszerekkel készültek és különböző területet fednek le (pl.: populizmus, pártprogramok policy tartalma, érzelmek, gazdasági tartalom.)<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></li>
<li>Relatíve könnyen adaptálható egyik nyelvi környezetből másikba.</li>
</ul>
<p><strong>A módszer lehetéges hátrányai:</strong></p>
<ul>
<li>A szótár hatékonysága és validitása azon múlik hogy mennyire egyezik a szótár és a viszgálni kívánt dokumentum területe. Például jellemző hiba, hogy gazdasági bizonytalanságot szeretnék tőzsdei jelentések alapján vizsgálni a kutatók egy általános szentimet szótár használatával.</li>
<li>A terület-specifikus szótár építése egy kvalitatív folyamat (lsd. a labjegyzetben), éppen ezért gyakran idő és emberi erőforrás igényes.</li>
<li>A szózsák alapú elemzéseknél a kontextus elvész (ez gyakran igaz a bigram és trigramok használatánál is) a kulcsszavak esetében. Erre egy triviális példa a tagadás a mondatban: <em>“nem vagyok boldog”</em> esetén egy általános szentiment szótár a tagadás miatt félreosztályozná a mondat érzelmi töltését.</li>
</ul>
<p>Az elemzés sikere több faktortól is függ. Fontos hogy a korpuszban lévő dokumentumokat körültekintően tisztítsuk meg az elemzés elején (lásd a 4. fejezetet a szövegelőkészítésről). A következő lépésben meg kell bizonyosodnunk arról, hogy a kiválasztott szentiment szótár alkalmazható a korpuszunkra. Amennyiben nem találunk alkalmas szótárat, akkor a saját szótár validálására kell figyelni. A negyedik fejezetben leírtak itt is érvényesek, érdemes a dokumentum-kifejezés mátrixot súlyozni valamilyen módon.</p>
<div id="szótárak-az-r-ben" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Szótárak az R-ben</h2>
<p>A szótár alapú elemzéshez a <code>quanteda</code> csomagot fogjuk használni, illetve a 3. fejezetben már megismert <code>readr</code>, <code>stringr</code>, <code>dplyr</code> tidyverse csomagokat.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb37-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb37-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span></code></pre></div>
<p>Mielőtt a két esettanulmányt bemutatnánk, vizsgáljuk meg hogy hogyan néz ki egy szentiment szótár az R-ben. A szótárt kézzel úgy tudjuk létrehozni, hogy egy listán belül létrehozzuk karaktervektorként a kategóriákat és a kulcsszavakat és ezt a listát a quanteda dictionary függvényével eltároljuk.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-1" aria-hidden="true" tabindex="-1"></a>szentiment_szotar <span class="ot">&lt;-</span> <span class="fu">dictionary</span>(<span class="fu">list</span>(</span>
<span id="cb38-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pozitiv =</span> <span class="fu">c</span>(<span class="st">&quot;jó&quot;</span>, <span class="st">&quot;boldog&quot;</span>, <span class="st">&quot;öröm&quot;</span>),</span>
<span id="cb38-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">negativ =</span> <span class="fu">c</span>(<span class="st">&quot;rossz&quot;</span>, <span class="st">&quot;szomorú&quot;</span>, <span class="st">&quot;lehangoló&quot;</span>)</span>
<span id="cb38-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb38-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-6" aria-hidden="true" tabindex="-1"></a>szentiment_szotar</span>
<span id="cb38-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dictionary object with 2 key entries.</span></span>
<span id="cb38-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [pozitiv]:</span></span>
<span id="cb38-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - jó, boldog, öröm</span></span>
<span id="cb38-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [negativ]:</span></span>
<span id="cb38-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - rossz, szomorú, lehangoló</span></span></code></pre></div>
<p>A quanteda, quanteda.corpora és tidytext R csomagok több széles körben használt szentiment szótárat tartalmaznak, így nem kell kézzel replikálni minden egyes szótárat amit használni szeretnénk.</p>
<p>A szentiment elemzési munkafolyamat amit a részfejezetben bemutatunk a következő lépésekből áll:</p>
<ol style="list-style-type: decimal">
<li>dokumentumok betöltése</li>
<li>szöveg előkészítése</li>
<li>a korpusz létrehozása</li>
<li>dokumentum-kifejezés mátrix</li>
<li>szótár betöltése</li>
<li>a dokumentum-kifejezés mátrix szűrése a szótárban lévő kulcsszavakkal</li>
<li>az eredmény vizualizálása, további felhasználása</li>
</ol>
<p>A fejezetben két különböző korpuszt fogunk elemezni: a 2006-os Magyar Nemzet címlapjainak egy 252 cikkből álló mintájának szentimentjét vizsgáljuk egy magyar szentiment szótárral. A második korpusz a Magyar Nemzeti Bank angol nyelvű sajtóközleményeiből áll, amin bemutatjuk egy széles körben használt gazdasági szótár használatát.</p>
</div>
<div id="magyar-nemzet-cikkek" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Magyar Nemzet cikkek</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-1" aria-hidden="true" tabindex="-1"></a>mn_minta <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/magyar_nemzet_small.csv&quot;</span>)</span>
<span id="cb39-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mn_minta)</span>
<span id="cb39-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      doc_id           text              doc_date         </span></span>
<span id="cb39-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :   1.0   Length:2834        Min.   :2006-01-02  </span></span>
<span id="cb39-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 709.2   Class :character   1st Qu.:2006-03-29  </span></span>
<span id="cb39-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :1417.5   Mode  :character   Median :2006-06-28  </span></span>
<span id="cb39-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :1417.5                      Mean   :2006-06-28  </span></span>
<span id="cb39-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2125.8                      3rd Qu.:2006-09-26  </span></span>
<span id="cb39-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :2834.0                      Max.   :2006-12-29</span></span></code></pre></div>
<p>A <code>read_csv()</code> segítségével beolvassuk a Magyar Nemzet adatbázis egy kisebb részét, ami az esetünkben a 2006-os cimlapokon szereplő hírek . A <code>summary()</code>, ahogy a neve is mutatja, egy gyors áttekinténtést nyújt a betöltött adatbázisról. Látjuk, hogy 2834 sorbol (megfigyelés) és 3 oszlopból (változó) áll. Az első ránézésre látszik hogy a text változónk tartalmazza a szövegeket, és hogy tisztításra szorulnak.</p>
<p>Az első szöveget megnézve látjuk, hogy a standard előkészítési lépések mellett a sortörést (<code>\n</code>) is ki kell törölnünk.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb40-1" aria-hidden="true" tabindex="-1"></a>mn_minta<span class="sc">$</span>text[<span class="dv">1</span>]</span>
<span id="cb40-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Hat fovárosi képviselo öt percnél is kevesebbet beszélt egy év alatt a közgyulésben.\n\n\n\n\n\n\n\n\n\n\n&quot;</span></span></code></pre></div>
<p>Habár a <code>quanteda</code> is lehetőséget ad néhány elékészítő lépésre, érdemes ezt olyan céleszközzel tenni ami nagyobb rugalmasságot ad a kezünkbe. Mi erre a célra a <code>stringr</code> csomagot használjuk. Első lépésben kitöröljük a sortöréseket (<code>\n</code>), a központozást, számokat, kisbetűsítünk minden szót. Előfordulhat hogy (számunkra nehezen látható) extra szóközök maradnak a szövegben. Ezeket az <code>str_squish()</code>-el tüntetjük el. A szöveg eleji és végi extra szóközöket (ún. leading vagy trailing white space) az <code>str_trim()</code> vágja le.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-1" aria-hidden="true" tabindex="-1"></a>mn_tiszta <span class="ot">&lt;-</span> mn_minta <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>),</span>
<span id="cb41-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;[:punct:]&quot;</span>),</span>
<span id="cb41-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;[:digit:]&quot;</span>),</span>
<span id="cb41-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_to_lower</span>(text),</span>
<span id="cb41-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_trim</span>(text),</span>
<span id="cb41-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_squish</span>(text)</span>
<span id="cb41-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>A szöveg sokkal jobban néz ki, habár észrevehetjük hogy maradhattak benne problémás részek, főleg a sortörés miatt, ami sajnos hol egyes szavak közepén van (a jobbik eset), vagy pedig pont szóhatáron, ez esetben a két szó sajnos összevonódik. Az egyszerűség kedvéért feltételezzük hogy ez kellően ritkán fordul elő ahhoz hogy ne befolyásolja az elemzésünk eredményét.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb42-1" aria-hidden="true" tabindex="-1"></a>mn_tiszta<span class="sc">$</span>text[<span class="dv">1</span>]</span>
<span id="cb42-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;hat fovárosi képviselo öt percnél is kevesebbet beszélt egy év alatt a közgyulésben&quot;</span></span></code></pre></div>
<p>Miután kész a tiszta(bb) szövegünk, kreálunk egy korpuszt a quanteda <code>corpus()</code> fuggvenyevel. A létrehozott corpus objektum a szöveg mellett egyéb dokumentum meta adatokat is tud tárolni (dátum, író, hely, stb.) Ezeket mi is hozzáadhatjuk (erre majd látunk példát nemsokára) illetve amikor létrehozzuk a korpuszt a data frame-ünkből, akkor autómatikusan meta adatokként tárolódnak az változóink. Jelen esetben az egyetlen dokument változónk az a dátum lesz a szöveg mellett. A korpusz dokumentum változóihoz a <code>docvars()</code> segíségével tudunk hozzáférni.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-1" aria-hidden="true" tabindex="-1"></a>mn_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(mn_tiszta)</span>
<span id="cb43-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">docvars</span>(mn_corpus), <span class="dv">5</span>)</span>
<span id="cb43-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     doc_date</span></span>
<span id="cb43-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2006-01-02</span></span>
<span id="cb43-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 2006-01-02</span></span>
<span id="cb43-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 2006-01-02</span></span>
<span id="cb43-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 2006-01-02</span></span>
<span id="cb43-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 2006-01-02</span></span></code></pre></div>
<p>A következő lépés a dokument-kifejezés mátrix létrehozása a <code>dfm()</code> függvénnyel (ami a <em>document-feature matrix</em> rövidítése). Előszőr tokenekre bontjuk a szövegeket a <code>tokens()</code>-el, és aztán ezt a tokenizált szózsákot kapja meg a dfm inputnak. A sornak a végén a létrehozott mátrixunkat TF-IDF módszerrel súlyozzuk a <code>dfm_tfidf()</code> használatával.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb44-1" aria-hidden="true" tabindex="-1"></a>mn_dfm <span class="ot">&lt;-</span> mn_corpus <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens</span>(<span class="at">what =</span> <span class="st">&quot;word&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_tfidf</span>()</span></code></pre></div>
<p>A cikkek szentimentjét egy magyar szótárral fogjuk becsülni, amit a Társadalomtudmányi Kutatóközpont CSS-RECENS és a POLTEXTLab kutatói készítették.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> Két dimenziót tarlamaz (pozitív és negatív), 2299 pozitív és 2588 negatív kulcsszóval. Ez nem számít kirívóan nagynak a szótárak között, mivel az adott kategóriák minél teljesebb lefedése a cél. Azt is látjuk, hogy a kulcsszavak egyszavas tokenek (szóval nem érdemes bigramokat és trigramokat készítenünk a tokenizálás során), illetve nem szótövek (így szótöveznünk sem kell).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-1" aria-hidden="true" tabindex="-1"></a>poltext_szotar</span>
<span id="cb45-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dictionary object with 2 key entries.</span></span>
<span id="cb45-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [positive]:</span></span>
<span id="cb45-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - abszolút, ad, adaptív, adekvát, adócsökkentés, adókedvezmény, adomány, adományoz, adóreform, adottság, adottságú, áfacsökkentés, agilis, agytröszt, áhított, ajándék, ajándékoz, ajánl, ajánlott, akadálytalan [ ... and 2,279 more ]</span></span>
<span id="cb45-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [negative]:</span></span>
<span id="cb45-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - aberrált, abnormális, abnormalitás, abszurd, abszurditás, ádáz, adócsalás, adócsaló, adós, adósság, áfacsalás, áfacsaló, affér, aggasztó, aggodalom, aggódik, aggódás, agresszió, agresszíven, agresszivitás [ ... and 2,568 more ]</span></span></code></pre></div>
<p>Az egyes dokumentumok szentimentjét a <code>dfm_lookup()</code> becsüli, ahol az előző lépésben létrehozott súlyozott dfm az input és a magyar szentimentszótár a dictionary. Egy gyors pillantás az eredményre és látjuk hogy minden dokumentumhoz készült egy pozitív és egy negatív értéket. A TF-IDF súlyozás miatt nem látunk egész számokat (a súlyozás nélkül a sima szófrekvenciát kapnánk).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-1" aria-hidden="true" tabindex="-1"></a>mn_szentiment <span class="ot">&lt;-</span> <span class="fu">dfm_lookup</span>(mn_dfm, <span class="at">dictionary =</span> poltext_szotar)</span>
<span id="cb46-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mn_szentiment, <span class="dv">5</span>)</span>
<span id="cb46-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Document-feature matrix of: 5 documents, 2 features (40.0% sparse) and 1 docvar.</span></span>
<span id="cb46-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     features</span></span>
<span id="cb46-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; docs   positive  negative</span></span>
<span id="cb46-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1  0          0       </span></span>
<span id="cb46-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2  0.8375026 12.497973</span></span>
<span id="cb46-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    3  0          0       </span></span>
<span id="cb46-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    4 21.1044299  6.449036</span></span>
<span id="cb46-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    5 11.0358129  8.131890</span></span></code></pre></div>
<p>Ahhoz hogy fel tudjuk használni a kapott eredményt, érdemes dokumentumváltozóként eltárolni a korpuszban. Ezt a fent már használt <code>docvars()</code> segítségével tudjuk megtenni, ahol a második argumentumkét az új változó nevét adjuk meg stringként.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mn_corpus, <span class="st">&quot;pos&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mn_szentiment[, <span class="dv">1</span>])</span>
<span id="cb47-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mn_corpus, <span class="st">&quot;neg&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mn_szentiment[, <span class="dv">2</span>])</span>
<span id="cb47-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">docvars</span>(mn_corpus), <span class="dv">5</span>)</span>
<span id="cb47-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     doc_date        pos       neg</span></span>
<span id="cb47-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2006-01-02  0.0000000  0.000000</span></span>
<span id="cb47-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 2006-01-02  0.8375026 12.497973</span></span>
<span id="cb47-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 2006-01-02  0.0000000  0.000000</span></span>
<span id="cb47-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 2006-01-02 21.1044299  6.449036</span></span>
<span id="cb47-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 2006-01-02 11.0358129  8.131890</span></span></code></pre></div>
<p>Végül a kapott korpuszt a kiszámolt szentiment értékekkel a <code>quanteda</code>-ban lévő <code>convert()</code> fügvénnyel data frame-é alakítjuk. A convert függvény dokumentációját érdemes elolvasni, mert ennek segítségével tudjuk a <code>quanteda</code>-ban elkeszült objektumainkat átalakítani úgy, hogy azt más csomagok is tudják használni.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-1" aria-hidden="true" tabindex="-1"></a>mn_df <span class="ot">&lt;-</span> <span class="fu">convert</span>(mn_corpus, <span class="at">to =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb48-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mn_df)</span>
<span id="cb48-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     doc_id              text              doc_date               pos        </span></span>
<span id="cb48-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Length:2834        Length:2834        Min.   :2006-01-02   Min.   : 0.000  </span></span>
<span id="cb48-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Class :character   Class :character   1st Qu.:2006-03-29   1st Qu.: 0.000  </span></span>
<span id="cb48-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Median :2006-06-28   Median : 2.373  </span></span>
<span id="cb48-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        Mean   :2006-06-28   Mean   : 4.074  </span></span>
<span id="cb48-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        3rd Qu.:2006-09-26   3rd Qu.: 6.280  </span></span>
<span id="cb48-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                        Max.   :2006-12-29   Max.   :35.648  </span></span>
<span id="cb48-12"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       neg        </span></span>
<span id="cb48-13"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   : 0.000  </span></span>
<span id="cb48-14"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 0.000  </span></span>
<span id="cb48-15"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 2.037  </span></span>
<span id="cb48-16"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 3.528  </span></span>
<span id="cb48-17"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 5.348  </span></span>
<span id="cb48-18"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :39.096</span></span></code></pre></div>
<p>Mielőtt vizualizálnánk az eredményt érdemes a napi szintre aggregálni a szentimentet és egy nettó értéket kalkulálni.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-1" aria-hidden="true" tabindex="-1"></a>mn_df <span class="ot">&lt;-</span> mn_df <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc_date) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">daily_pos =</span> <span class="fu">sum</span>(pos),</span>
<span id="cb49-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">daily_neg =</span> <span class="fu">sum</span>(neg),</span>
<span id="cb49-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">net_daily =</span> daily_pos <span class="sc">-</span> daily_neg</span>
<span id="cb49-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>A plot alapján egyértelmű trendet nem lehet megállapítani és még a 2006-os év végi turbulens belpolitikai események sem feltétlenül jelennek meg markánsan. Ennek az oka abban is kereshető, hogy egy napilap címlapját ritkán dominálja teljes egészében a belpolitika és így a negatív és pozitív szentimentek kioltják egymást. Természetesen messzemenő következtetéseket egy ábra alapján nem érdemes levonni, de az elemzésünk azt mutatha hogy a nyári hónapok alatt kevesebb volt az igazán negatív címlap, ellenben az év eleje és vége tartalmazta a minta alsó szélső értékeit.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mn_df, <span class="fu">aes</span>(doc_date, net_daily)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Magyar Nemzet címlap szentimentje&quot;</span>,</span>
<span id="cb51-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;A szentiment érték a pozitív és negatív szentiment pontszámok különbsége a teljes mintára.&quot;</span>,</span>
<span id="cb51-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Szentiment&quot;</span>,</span>
<span id="cb51-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb51-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Adatforrás: https://cap.tk.hu/&quot;</span></span>
<span id="cb51-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="mnb-sajtóközlemények" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> MNB sajtóközlemények</h2>
<p>A második esettanulmányban a kotextuális szótár elemzést mutatjuk be egy angol nyelvű korpusz és specializált szótár segítségével. A korpusz az MNB kamatdöntéseit kísérő nemzetközi sajtóközleményei és a szótár pedig a <span class="citation"><a href="függelék.html#ref-loughran2011" role="doc-biblioref">Loughran and McDonald</a> (<a href="függelék.html#ref-loughran2011" role="doc-biblioref">2011</a>)</span> pénzügyi szentimentszótár.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> A szótár a <code>quanteda.dictionaries</code> csomag részeként elérhető, illetve a tankönyv honlapján is megtalálható.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-1" aria-hidden="true" tabindex="-1"></a>penzugy_szentiment</span>
<span id="cb52-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dictionary object with 9 key entries.</span></span>
<span id="cb52-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [NEGATIVE]:</span></span>
<span id="cb52-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - abandon, abandoned, abandoning, abandonment, abandonments, abandons, abdicated, abdicates, abdicating, abdication, abdications, aberrant, aberration, aberrational, aberrations, abetting, abnormal, abnormalities, abnormality, abnormally [ ... and 2,335 more ]</span></span>
<span id="cb52-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [POSITIVE]:</span></span>
<span id="cb52-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - able, abundance, abundant, acclaimed, accomplish, accomplished, accomplishes, accomplishing, accomplishment, accomplishments, achieve, achieved, achievement, achievements, achieves, achieving, adequately, advancement, advancements, advances [ ... and 334 more ]</span></span>
<span id="cb52-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [UNCERTAINTY]:</span></span>
<span id="cb52-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - abeyance, abeyances, almost, alteration, alterations, ambiguities, ambiguity, ambiguous, anomalies, anomalous, anomalously, anomaly, anticipate, anticipated, anticipates, anticipating, anticipation, anticipations, apparent, apparently [ ... and 277 more ]</span></span>
<span id="cb52-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [LITIGIOUS]:</span></span>
<span id="cb52-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - abovementioned, abrogate, abrogated, abrogates, abrogating, abrogation, abrogations, absolve, absolved, absolves, absolving, accession, accessions, acquirees, acquirors, acquit, acquits, acquittal, acquittals, acquittance [ ... and 883 more ]</span></span>
<span id="cb52-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [CONSTRAINING]:</span></span>
<span id="cb52-12"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - abide, abiding, bound, bounded, commit, commitment, commitments, commits, committed, committing, compel, compelled, compelling, compels, comply, compulsion, compulsory, confine, confined, confinement [ ... and 164 more ]</span></span>
<span id="cb52-13"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; - [SUPERFLUOUS]:</span></span>
<span id="cb52-14"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   - aegis, amorphous, anticipatory, appertaining, assimilate, assimilating, assimilation, bifurcated, bifurcation, cessions, cognizable, concomitant, correlative, deconsolidation, delineation, demonstrable, demonstrably, derecognized, derecognizes, derivatively [ ... and 36 more ]</span></span>
<span id="cb52-15"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [ reached max_nkey ... 3 more keys ]</span></span></code></pre></div>
<p>A szentiment szótár 9 kategóriából áll. A legtöbb kulcsszó a negatív dimenzióhoz van (2355).</p>
<p>A munkamenet hasonló a Magyar Nemzetes példához:</p>
<ol style="list-style-type: decimal">
<li>adat betöltés</li>
<li>szövegtisztítás</li>
<li>korpusz</li>
<li>tokenek</li>
<li>kulcs kontextuális tokenek szűrése</li>
<li>dfm előállítás és szentiment számítás</li>
<li>az eredmény vizualizálása, további felhasználása</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-1" aria-hidden="true" tabindex="-1"></a>mnb_pr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/mnb_pr_corpus.csv&quot;</span>)</span>
<span id="cb53-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mnb_pr)</span>
<span id="cb53-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       date                text                 id              year     </span></span>
<span id="cb53-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :2005-01-24   Length:180         Min.   :  1.00   Min.   :2005  </span></span>
<span id="cb53-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:2008-10-14   Class :character   1st Qu.: 45.75   1st Qu.:2008  </span></span>
<span id="cb53-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :2012-07-10   Mode  :character   Median : 90.50   Median :2012  </span></span>
<span id="cb53-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :2012-07-08                      Mean   : 90.50   Mean   :2012  </span></span>
<span id="cb53-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:2016-03-30                      3rd Qu.:135.25   3rd Qu.:2016  </span></span>
<span id="cb53-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :2019-12-17                      Max.   :180.00   Max.   :2019</span></span></code></pre></div>
<p>Az adatbázisunk 180 megfigyelésből és 4 változóbol áll. Az egyetlen lényeges dokumentum meta adat itt is a szövegek megjelenési ideje.</p>
<p>A szövegeket ugyanazokkal a standard eszközökkel kezeljük mint a Magyar Nemzet esetében. Érdemes minden esetben ellenőrízni, hogy az R kód amit használunk az tényleg azt csinálja-e mint amit szeretnénk hogy csináljon. Ez hatványozottan igaz abban az esetben, amikor szövegekkel és regular expressionökkel dolgozunk.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-1" aria-hidden="true" tabindex="-1"></a>mnb_tiszta <span class="ot">&lt;-</span> mnb_pr <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;[:cntrl:]&quot;</span>),</span>
<span id="cb54-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;[:punct:]&quot;</span>),</span>
<span id="cb54-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_remove_all</span>(<span class="at">string =</span> text, <span class="at">pattern =</span> <span class="st">&quot;[:digit:]&quot;</span>),</span>
<span id="cb54-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_to_lower</span>(text),</span>
<span id="cb54-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_trim</span>(text),</span>
<span id="cb54-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">str_squish</span>(text)</span>
<span id="cb54-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb54-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Miután rendelkezésre állnak a tiszta dokumentumaink, egy karaktervektorba gyüjtjuk azokat a kulcsszavakat amelyek környékén szeretnénk megfigyelni a szentiment alakulását. A példa kedvéért mi az <code>unemp*</code>, <code>growth</code>, <code>gdp</code>, <code>inflation*</code> szótöveket és szavakat választottuk. A <code>tokens_keep()</code> megtartja a kulcsszavainkat és egy általunk megadott +/- n tokenes környezetüket (jelen esetben 10). A szentiment elemzést pedig már ezen a jóval kisebb mátrixon fogjuk lefuttatni. A <code>phrase()</code> segítségével több szóból álló kifejezéséket is vizsgálhatunk. Ilyen szókapcsolat például az <em>Európai Unió</em> is, ahol lényeges hogy egyben kezeljük a két szót.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-1" aria-hidden="true" tabindex="-1"></a>mnb_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(mnb_tiszta)</span>
<span id="cb55-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-3" aria-hidden="true" tabindex="-1"></a>gazdasag <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;unemp*&quot;</span>, <span class="st">&quot;growth&quot;</span>, <span class="st">&quot;gdp&quot;</span>, <span class="st">&quot;inflation*&quot;</span>, <span class="st">&quot;inflation expectation*&quot;</span>)</span>
<span id="cb55-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-5" aria-hidden="true" tabindex="-1"></a>mnb_token <span class="ot">&lt;-</span> <span class="fu">tokens</span>(mnb_corpus) <span class="sc">%&gt;%</span></span>
<span id="cb55-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_keep</span>(<span class="at">pattern =</span> <span class="fu">phrase</span>(gazdasag), <span class="at">window =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>A szentimentet most is egy súlyozott dfm-ből számoljuk. A kész eredményt hozzáadjuk a korpuszhoz majd data framet hozunk létre belőle. A 9 kategóriából 5-öt adunk választunk csak ki, amelyeknek jegybanki környezetben értelmezhető tartalma van.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-1" aria-hidden="true" tabindex="-1"></a>mnb_szentiment <span class="ot">&lt;-</span> <span class="fu">tokens_lookup</span>(mnb_token, <span class="at">dictionary =</span> penzugy_szentiment) <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_tfidf</span>()</span>
<span id="cb56-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mnb_corpus, <span class="st">&quot;negative&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mnb_szentiment[, <span class="st">&quot;negative&quot;</span>])</span>
<span id="cb56-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mnb_corpus, <span class="st">&quot;positive&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mnb_szentiment[, <span class="st">&quot;positive&quot;</span>])</span>
<span id="cb56-9"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mnb_corpus, <span class="st">&quot;uncertainty&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mnb_szentiment[, <span class="st">&quot;uncertainty&quot;</span>])</span>
<span id="cb56-10"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mnb_corpus, <span class="st">&quot;constraining&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mnb_szentiment[, <span class="st">&quot;constraining&quot;</span>])</span>
<span id="cb56-11"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(mnb_corpus, <span class="st">&quot;superfluous&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mnb_szentiment[, <span class="st">&quot;superfluous&quot;</span>])</span>
<span id="cb56-12"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb56-14" aria-hidden="true" tabindex="-1"></a>mnb_df <span class="ot">&lt;-</span> <span class="fu">convert</span>(mnb_corpus, <span class="at">to =</span> <span class="st">&quot;data.frame&quot;</span>)</span></code></pre></div>
<p>A célunk hogy szentiment kategóriánkénti bontásban mutassuk be az elemzésünk eredményét, de előtte egy kicsit alakítani kell a data frame-n, hogy a második fejezetben is tárgyalt <em>tidy</em> formára hozzuk. A különböző szentiment értékeket tartalmazó oszlopokat fogjuk átrendezni úgy hogy kreálunk egy “sent_type” változót ahol a kategória nevet fogjuk eltárolni és egy “sent_score” változót, ahol a szentiment értéket. Ehhez a <code>tidyr</code>-ben található <code>pivot_longer()</code> -t használjuk.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-1" aria-hidden="true" tabindex="-1"></a>mnb_df <span class="ot">&lt;-</span> mnb_df <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb57-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> negative<span class="sc">:</span>superfluous,</span>
<span id="cb57-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;sent_type&quot;</span>,</span>
<span id="cb57-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;sent_score&quot;</span></span>
<span id="cb57-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Az átalakítás után már könnyedén tudjuk kategóriákra bontva megjeleníteni az MNB közlemények különböző látens dimenzióit. Fontos emlékezni arra, hogy ez az eredmény a kulcsszavaink +/- 10 tokenes környezetében lévő szavak szentimentjét mérik. Ami érdekes eredmény, hogy a felesleges “töltelék” szövegek (superflous kategória) szinte soha nem fordulnak elő a kulcsszavaink körül. A többi érték is nagyjából megfelel a várakozásainknak, habár a 2008-as gazdasági válság nem tűnik kiugró pontnak. Azonban a 2010 utáni európai válság már láthatóan megjelnik az idősorainkban.</p>
<p>A szótár amit használtunk az alapvetően az Egyesült Államokban a tőzsdén kereskedett cégek publikus beszámolóiból készült így elképzelhető, hogy egyes jegybanki környezetben sokat használt kifejezés nincs benne. A validálása a kapott eredményeknek ezért is nagyon fontos, illetve érdemes azzal is tisztában lenni hogy a szótáras módszer nem tökéletes (ahogy az emberi vagy más gépi kódolás sem).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mnb_df, <span class="fu">aes</span>(date, sent_score)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb58-3"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-4"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Magyar Nemzeti Bank közleményeinek szentimentje&quot;</span>,</span>
<span id="cb58-5"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Szentiment&quot;</span>,</span>
<span id="cb58-6"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb58-7"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-8"><a href="szótáralapú-elemzések-érzelem-elemzés.html#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sent_type, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="90%" style="display: block; margin: auto;" /></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>A lehetséges, területspecifikus szótáralkotási módszerekről részletesebben ezekben a cikkekben lehet olvasni: <span class="citation"><a href="függelék.html#ref-laver2000estimating" role="doc-biblioref">Laver and Garry</a> (<a href="függelék.html#ref-laver2000estimating" role="doc-biblioref">2000</a>)</span>; <span class="citation"><a href="függelék.html#ref-young2012affective" role="doc-biblioref">Young and Soroka</a> (<a href="függelék.html#ref-young2012affective" role="doc-biblioref">2012</a>)</span>; <span class="citation"><a href="függelék.html#ref-loughran2011" role="doc-biblioref">Loughran and McDonald</a> (<a href="függelék.html#ref-loughran2011" role="doc-biblioref">2011</a>)</span>; <span class="citation"><a href="függelék.html#ref-máté2021" role="doc-biblioref">Máté, Sebők, and Barczikay</a> (<a href="függelék.html#ref-máté2021" role="doc-biblioref">2021</a>)</span><a href="szótáralapú-elemzések-érzelem-elemzés.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>A szentiment elemzéshez gyakran használt csomag még a tidytext. Az online is szabadon elérhető <span class="citation"><a href="függelék.html#ref-silge2017text" role="doc-biblioref">Silge and Robinson</a> (<a href="függelék.html#ref-silge2017text" role="doc-biblioref">2017</a>)</span> 2. fejezetében részletesen is bemutatják a szerzők a tidytext munkafolyamatot (<a href="https://www.tidytextmining.com/sentiment.html" class="uri">https://www.tidytextmining.com/sentiment.html</a>).<a href="szótáralapú-elemzések-érzelem-elemzés.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>A szótár elérhető a könyv online verziójának a GitHub repozitorijából. (LINK)<a href="szótáralapú-elemzések-érzelem-elemzés.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>A csoportosított adatokkal való munka bővebb bemutatását lsd. a Függelékben<a href="szótáralapú-elemzések-érzelem-elemzés.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>A témával részletesebben is foglalkoztunk a <span class="citation"><a href="függelék.html#ref-máté2021" role="doc-biblioref">Máté, Sebők, and Barczikay</a> (<a href="függelék.html#ref-máté2021" role="doc-biblioref">2021</a>)</span> tanulmányban, ahol egy saját monetáris szentiment szótárt mutatunk be. Az implementáció és a hozzá tartozó R forráskód a nyilvános <a href="https://doi.org/10.6084/m9.figshare.13526156.v1" class="uri">https://doi.org/10.6084/m9.figshare.13526156.v1</a> linken.<a href="szótáralapú-elemzések-érzelem-elemzés.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-korpuszépítés-problémái-és-a-szövegel-készítés.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="felügyelet-nélküli-tanulás-topik-modellezés-magyar-törvényszövegeken.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
